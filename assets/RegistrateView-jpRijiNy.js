import{a as m}from"./axios-5KWFXKlW.js";import{d as E,_ as I,m as R,e as V,c,a as d,w as y,b as e,f as D,F as w,r as u,o as i,n as f,t as b,g as k,h as L}from"./index-D01cEAR3.js";const x=E("telStore",{state:()=>({tel:""}),actions:{setTel(s){localStorage.setItem("tel",s),this.tel=s},getTel(){const s=localStorage.getItem("tel");this.tel=s}}}),A="/agree/assets/%E6%AF%8D%E8%A6%AA%E7%AF%80DM_20240417-%E5%AE%8C%E7%A8%BF6-t_cL7T4R.jpg";var S={VITE_APP_API_URL:"https://testappbackend.jutretail.com.tw",VITE_APP_API_NAME:"lottery-registration",BASE_URL:"/agree/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:p,VITE_APP_API_NAME:_}=S,F={data(){return{userData:{tel:""},isRegistration:!1,type:"create",telId:0}},methods:{...R(x,["setTel","getTel"]),handleOrderSubmit(s){this.type==="create"?this.postForm():this.type==="update"&&this.updateApi(this.telId)},updateInput(s){this.type=s,this.isRegistration=!1},getDate(){const s=`${p}/${_}`;m.get(s).then(t=>{console.log(this.tel),this.getTel();const a=t.data;this.isRegistration=a.some(n=>(n.tel===this.tel&&(this.telId=n.id),n.tel===this.tel))}).catch(t=>{console.log(t)})},postForm(){const s=`${p}/${_}`;m.post(s,this.userData).then(t=>{console.log(t.data),t.data.success&&(this.setTel(this.userData.tel),alert("提交成功"),window.location="https://testappcrm.jutretail.com.tw/Pages/LuckyIndex.aspx")}).catch(()=>{alert("此號碼已參加活動"),this.goLuckyPage()})},updateApi(s){console.log("id",s);const t=`${p}/${_}/${s}`;m.put(t,this.userData).then(a=>{console.log(a.data),a.data.success&&(this.isRegistration=!0,this.setTel(this.userData.tel),this.type="create",alert("已完成修改"),this.goLuckyPage())}).catch(a=>{alert("此號碼已存在")})},goLuckyPage(){window.location="https://testappcrm.jutretail.com.tw/Pages/LuckyIndex.aspx"}},computed:{...V(x,["tel"])},created(){this.getDate(),console.log("isRegistration",this.isRegistration)}},C=e("img",{src:"https://noke.jutretail.com.tw/images/logo.png",alt:"logo"},null,-1),j={class:"container"},B={key:0,class:"form-group text-center mb-5"},M=e("h3",{class:"fw-bold mt-5"},"您先前已報名成功!",-1),N=e("img",{class:"w-100 d-block",src:A,alt:""},null,-1),O={class:"col-md-4 mb-2 mx-auto"},U=e("label",{for:"orderTel",class:"sr-only text-primary py-3"},[e("span",{class:"text-danger me-1 align-middle"},"*"),L("手機號碼")],-1),$=e("img",{class:"w-100 d-block",src:A,alt:""},null,-1),q={key:0,class:"col-md-4 mb-2 mx-auto"},z=e("span",{class:"text-danger me-1 align-middle"},"*",-1),W={class:"form-group form-check"},G=e("label",{for:"acceptTerms",class:"form-check-label"},"我同意",-1),H={class:"invalid-feedback"},J={class:"form-group text-center my-5 d-flex justify-content-evenly"},K={type:"submit",class:"btn btn-primary mr-1"};function Q(s,t,a,n,l,r){const P=u("RouterLink"),g=u("VField"),T=u("ErrorMessage"),v=u("VForm");return i(),c(w,null,[d(P,{to:"/"},{default:y(()=>[C]),_:1}),e("div",j,[l.isRegistration?(i(),c("div",B,[M,N,e("button",{class:"btn btn-primary my-4 d-block mx-auto",onClick:t[0]||(t[0]=o=>r.updateInput("update"))},"更換其他號碼參加活動"),e("button",{onClick:t[1]||(t[1]=(...o)=>r.goLuckyPage&&r.goLuckyPage(...o)),type:"button",class:"btn btn-secondary my-4 d-block mx-auto"},"查詢抽獎號嗎")])):(i(),D(v,{key:1,onSubmit:t[4]||(t[4]=o=>r.handleOrderSubmit(o))},{default:y(({errors:o})=>[e("div",O,[U,d(g,{type:"tel",id:"orderTel",name:"手機號碼",class:f(["form-control",{"is-invalid":o.手機號碼}]),placeholder:"請輸入手機號碼",rules:"required|numeric|min:10|max:10|startsWith09",modelValue:l.userData.tel,"onUpdate:modelValue":t[2]||(t[2]=h=>l.userData.tel=h)},null,8,["class","modelValue"]),d(T,{name:"手機號碼",class:"invalid-feedback"})]),$,l.type==="create"?(i(),c("div",q,[e("div",{class:f(["d-flex",{"is-invalid":o.acceptTerms}])},[z,e("div",W,[d(g,{name:"acceptTerms",type:"checkbox",id:"acceptTerms",value:!0,class:"form-check-input",rules:"required"}),G])],2),e("div",H,b(o.acceptTerms?"請勾選同意":""),1)])):k("",!0),e("div",J,[e("button",K,b(l.type==="create"?"參加活動":"送出"),1),l.type==="update"?(i(),c("button",{key:0,onClick:t[3]||(t[3]=h=>this.isRegistration=!0),type:"button",class:"btn btn-secondary"},"返回")):k("",!0)])]),_:1}))])],64)}const Z=I(F,[["render",Q]]);export{Z as default};
