import{a as p}from"./axios-5KWFXKlW.js";import{f as I,_ as P,m as S,g as V,c as n,a as s,h as A,w as D,r as u,o as i,t as m,b as h,n as y,i as k,p as R,e as E}from"./index-9r1NO0zf.js";const x=I("telStore",{state:()=>({tel:""}),actions:{setTel(t){localStorage.setItem("tel",t),this.tel=t},getTel(){const t=localStorage.getItem("tel");this.tel=t}}}),v="/agree/assets/notice-BTXavxoQ.jpg";var L={VITE_APP_API_URL:"https://testappbackend.jutretail.com.tw",VITE_APP_API_NAME:"lottery-registration",BASE_URL:"/agree/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:g,VITE_APP_API_NAME:_}=L,C={data(){return{userData:{tel:""},isRegistration:!1,type:"create",telId:0,changeTitle:!1}},methods:{...S(x,["setTel","getTel"]),handleOrderSubmit(t){this.type==="create"?this.postForm():this.type==="update"&&this.updateApi(this.telId)},updateInput(t){this.type=t,this.isRegistration=!1},getDate(){const t=`${g}/${_}`;p.get(t).then(e=>{console.log(this.tel),this.getTel();const l=e.data;this.isRegistration=l.some(r=>(r.tel===this.tel&&(this.telId=r.id),r.tel===this.tel))}).catch(e=>{console.log(e)})},postForm(){const t=`${g}/${_}`;p.post(t,this.userData).then(e=>{console.log(e.data),e.data.success&&(this.setTel(this.userData.tel),alert("提交成功"),window.location="https://testappcrm.jutretail.com.tw/Pages/LuckyIndex.aspx")}).catch(()=>{alert("此號碼已參加活動"),this.goLuckyPage()})},updateApi(t){console.log("id",t);const e=`${g}/${_}/${t}`;p.put(e,this.userData).then(l=>{console.log(l.data),l.data.success&&(this.isRegistration=!0,this.setTel(this.userData.tel),this.type="create",alert("已完成修改"),this.goLuckyPage())}).catch(l=>{alert("此號碼已存在")})},goLuckyPage(){window.location="https://testappcrm.jutretail.com.tw/Pages/LuckyIndex.aspx"}},computed:{...V(x,["tel"])},created(){this.getDate(),console.log("isRegistration",this.isRegistration)}},d=t=>(R("data-v-57c44d00"),t=t(),E(),t),F={class:"bg-151515"},B={class:"container"},j={key:0,class:"form-group text-center pb-5"},M=d(()=>s("h3",{class:"fw-bold pt-5 text-primary"},"您先前已報名成功!",-1)),N=d(()=>s("div",{class:"col-lg-5 mx-auto"},[s("img",{class:"w-100 d-block",src:v,alt:""})],-1)),O={class:"col-md-4 mb-2 mx-auto"},U={for:"orderTel",class:"sr-only text-primary fw-bold d-block py-4 text-center fs-1"},q=d(()=>s("div",{class:"col-lg-5 mx-auto"},[s("img",{class:"w-100 mb-1",src:v,alt:""})],-1)),z={key:0,class:"col-md-4 mb-2 mx-auto"},Q={class:"form-group form-check mx-auto"},W=d(()=>s("label",{for:"acceptTerms",class:"form-check-label text-white noticeFont"},"已閱讀以上注意事項並同意參加",-1)),X={class:"invalid-feedback text-center"},$={class:"form-group text-center mt-5 pb-5 d-flex justify-content-evenly"},G={type:"submit",class:"btn btn-primary mr-1 fw-bold border-white"};function H(t,e,l,r,o,c){const b=u("VField"),w=u("ErrorMessage"),T=u("VForm");return i(),n("div",F,[s("div",B,[o.isRegistration?(i(),n("div",j,[M,N,s("button",{class:"btn btn-primary my-4 d-block mx-auto border-white fw-bold",onClick:e[0]||(e[0]=a=>(c.updateInput("update"),o.changeTitle=!0))},"更換其他號碼參加活動"),s("button",{onClick:e[1]||(e[1]=(...a)=>c.goLuckyPage&&c.goLuckyPage(...a)),type:"button",class:"btn btn-primary border-white d-block mx-auto fw-bold"},"查詢抽獎號嗎")])):(i(),A(T,{key:1,onSubmit:e[4]||(e[4]=a=>c.handleOrderSubmit(a))},{default:D(({errors:a})=>[s("div",O,[s("label",U,m(o.changeTitle?"更換手機號碼":"登錄手機號碼抽獎"),1),h(b,{type:"tel",id:"orderTel",name:"手機號碼",class:y(["form-control bg-white",{"is-invalid":a.手機號碼}]),placeholder:"請輸入手機號碼",rules:"required|numeric|min:10|max:10|startsWith09",modelValue:o.userData.tel,"onUpdate:modelValue":e[2]||(e[2]=f=>o.userData.tel=f)},null,8,["class","modelValue"]),h(w,{name:"手機號碼",class:"invalid-feedback"})]),q,o.type==="create"?(i(),n("div",z,[s("div",{class:y(["d-flex",{"is-invalid":a.acceptTerms}])},[s("div",Q,[h(b,{name:"acceptTerms",type:"checkbox",id:"acceptTerms",value:!0,class:"form-check-input",rules:"required"}),W])],2),s("div",X,m(a.acceptTerms?"請勾選同意":""),1)])):k("",!0),s("div",$,[s("button",G,m(o.type==="create"?"參加活動":"送出"),1),o.type==="update"?(i(),n("button",{key:0,onClick:e[3]||(e[3]=f=>this.isRegistration=!0),type:"button",class:"btn btn-primary fw-bold border-white"},"返回")):k("",!0)])]),_:1}))])])}const Y=P(C,[["render",H],["__scopeId","data-v-57c44d00"]]);export{Y as default};
