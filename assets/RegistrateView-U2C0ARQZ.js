import{a as m}from"./axios-5KWFXKlW.js";import{d as v,_ as E,m as I,e as R,c as n,a as d,w as f,b as s,f as D,F as V,r as u,o as i,t as p,n as y,g as k}from"./index-CC66Fg-s.js";const x=v("telStore",{state:()=>({tel:""}),actions:{setTel(e){localStorage.setItem("tel",e),this.tel=e},getTel(){const e=localStorage.getItem("tel");this.tel=e}}}),T="/agree/assets/%E6%AF%8D%E8%A6%AA%E7%AF%80DM_20240417-%E5%AE%8C%E7%A8%BF6-t_cL7T4R.jpg";var L={VITE_APP_API_URL:"https://testappbackend.jutretail.com.tw",VITE_APP_API_NAME:"lottery-registration",BASE_URL:"/agree/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:h,VITE_APP_API_NAME:g}=L,S={data(){return{userData:{tel:""},isRegistration:!1,type:"create",telId:0,changeTitle:!1}},methods:{...I(x,["setTel","getTel"]),handleOrderSubmit(e){this.type==="create"?this.postForm():this.type==="update"&&this.updateApi(this.telId)},updateInput(e){this.type=e,this.isRegistration=!1},getDate(){const e=`${h}/${g}`;m.get(e).then(t=>{console.log(this.tel),this.getTel();const l=t.data;this.isRegistration=l.some(r=>(r.tel===this.tel&&(this.telId=r.id),r.tel===this.tel))}).catch(t=>{console.log(t)})},postForm(){const e=`${h}/${g}`;m.post(e,this.userData).then(t=>{console.log(t.data),t.data.success&&(this.setTel(this.userData.tel),alert("提交成功"),window.location="https://testappcrm.jutretail.com.tw/Pages/LuckyIndex.aspx")}).catch(()=>{alert("此號碼已參加活動"),this.goLuckyPage()})},updateApi(e){console.log("id",e);const t=`${h}/${g}/${e}`;m.put(t,this.userData).then(l=>{console.log(l.data),l.data.success&&(this.isRegistration=!0,this.setTel(this.userData.tel),this.type="create",alert("已完成修改"),this.goLuckyPage())}).catch(l=>{alert("此號碼已存在")})},goLuckyPage(){window.location="https://testappcrm.jutretail.com.tw/Pages/LuckyIndex.aspx"}},computed:{...R(x,["tel"])},created(){this.getDate(),console.log("isRegistration",this.isRegistration)}},F=s("img",{src:"https://noke.jutretail.com.tw/images/logo.png",alt:"logo"},null,-1),C={class:"container"},j={key:0,class:"form-group text-center mb-5"},B=s("h3",{class:"fw-bold mt-5 text-blue"},"您先前已報名成功!",-1),M=s("img",{class:"w-100 d-block",src:T,alt:""},null,-1),N={class:"col-md-4 mb-2 mx-auto"},O={for:"orderTel",class:"sr-only text-blue fw-bold d-block py-3 text-center fs-2"},U=s("img",{class:"w-100 d-block",src:T,alt:""},null,-1),q={key:0,class:"col-md-4 mb-2 mx-auto"},z={class:"form-group form-check"},W=s("label",{for:"acceptTerms",class:"form-check-label text-white"},"已閱讀以上注意事項並同意參加",-1),$={class:"invalid-feedback"},G={class:"form-group text-center my-5 d-flex justify-content-evenly"},H={type:"submit",class:"btn btn-primary mr-1 border-white"};function J(e,t,l,r,o,c){const A=u("RouterLink"),_=u("VField"),w=u("ErrorMessage"),P=u("VForm");return i(),n(V,null,[d(A,{to:"/"},{default:f(()=>[F]),_:1}),s("div",C,[o.isRegistration?(i(),n("div",j,[B,M,s("button",{class:"btn btn-primary my-4 d-block mx-auto border-white",onClick:t[0]||(t[0]=a=>(c.updateInput("update"),o.changeTitle=!0))},"更換其他號碼參加活動"),s("button",{onClick:t[1]||(t[1]=(...a)=>c.goLuckyPage&&c.goLuckyPage(...a)),type:"button",class:"btn btn-secondary my-4 d-block mx-auto"},"查詢抽獎號嗎")])):(i(),D(P,{key:1,onSubmit:t[4]||(t[4]=a=>c.handleOrderSubmit(a))},{default:f(({errors:a})=>[s("div",N,[s("label",O,p(o.changeTitle?"更換手機號碼":"登錄手機號碼抽獎"),1),d(_,{type:"tel",id:"orderTel",name:"手機號碼",class:y(["form-control bg-white",{"is-invalid":a.手機號碼}]),placeholder:"請輸入手機號碼",rules:"required|numeric|min:10|max:10|startsWith09",modelValue:o.userData.tel,"onUpdate:modelValue":t[2]||(t[2]=b=>o.userData.tel=b)},null,8,["class","modelValue"]),d(w,{name:"手機號碼",class:"invalid-feedback"})]),U,o.type==="create"?(i(),n("div",q,[s("div",{class:y(["d-flex",{"is-invalid":a.acceptTerms}])},[s("div",z,[d(_,{name:"acceptTerms",type:"checkbox",id:"acceptTerms",value:!0,class:"form-check-input border-white",rules:"required"}),W])],2),s("div",$,p(a.acceptTerms?"請勾選同意":""),1)])):k("",!0),s("div",G,[s("button",H,p(o.type==="create"?"參加活動":"送出"),1),o.type==="update"?(i(),n("button",{key:0,onClick:t[3]||(t[3]=b=>this.isRegistration=!0),type:"button",class:"btn btn-secondary"},"返回")):k("",!0)])]),_:1}))])],64)}const X=E(S,[["render",J]]);export{X as default};
