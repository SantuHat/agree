import{a as u}from"./axios-5KWFXKlW.js";import{f as A,_ as I,m as P,g as w,c as n,a as s,h as E,w as S,r as p,o as i,t as m,b as h,n as y,i as k,p as D,e as V}from"./index-ChzhRXeb.js";const x=A("telStore",{state:()=>({tel:""}),actions:{setTel(t){localStorage.setItem("tel",t),this.tel=t},getTel(){const t=localStorage.getItem("tel");this.tel=t}}}),R="/agree/assets/%E6%AF%8D%E8%A6%AA%E7%AF%80DM_20240417-%E5%AE%8C%E7%A8%BF6-t_cL7T4R.jpg",L="/agree/assets/65311-CS8CU4LN.jpg";var C={VITE_APP_API_URL:"https://testappbackend.jutretail.com.tw",VITE_APP_API_NAME:"lottery-registration",BASE_URL:"/agree/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:_,VITE_APP_API_NAME:g}=C,F={data(){return{userData:{tel:""},isRegistration:!1,type:"create",telId:0,changeTitle:!1}},methods:{...P(x,["setTel","getTel"]),handleOrderSubmit(t){this.type==="create"?this.postForm():this.type==="update"&&this.updateApi(this.telId)},updateInput(t){this.type=t,this.isRegistration=!1},getDate(){const t=`${_}/${g}`;u.get(t).then(e=>{console.log(this.tel),this.getTel();const l=e.data;this.isRegistration=l.some(c=>(c.tel===this.tel&&(this.telId=c.id),c.tel===this.tel))}).catch(e=>{console.log(e)})},postForm(){const t=`${_}/${g}`;u.post(t,this.userData).then(e=>{console.log(e.data),e.data.success&&(this.setTel(this.userData.tel),alert("提交成功"),window.location="https://testappcrm.jutretail.com.tw/Pages/LuckyIndex.aspx")}).catch(()=>{alert("此號碼已參加活動"),this.goLuckyPage()})},updateApi(t){console.log("id",t);const e=`${_}/${g}/${t}`;u.put(e,this.userData).then(l=>{console.log(l.data),l.data.success&&(this.isRegistration=!0,this.setTel(this.userData.tel),this.type="create",alert("已完成修改"),this.goLuckyPage())}).catch(l=>{alert("此號碼已存在")})},goLuckyPage(){window.location="https://testappcrm.jutretail.com.tw/Pages/LuckyIndex.aspx"}},computed:{...w(x,["tel"])},created(){this.getDate(),console.log("isRegistration",this.isRegistration)}},d=t=>(D("data-v-81f94c8a"),t=t(),V(),t),j={class:"bg-151515"},B={class:"container"},M={key:0,class:"form-group text-center mb-5"},N=d(()=>s("h3",{class:"fw-bold mt-5 text-blue"},"您先前已報名成功!",-1)),U=d(()=>s("img",{class:"w-100 d-block",src:R,alt:""},null,-1)),O={class:"col-md-4 mb-2 mx-auto"},q={for:"orderTel",class:"sr-only text-primary fw-bold d-block py-4 text-center fs-1"},z=d(()=>s("div",{class:"col-lg-5 mx-auto"},[s("img",{class:"w-100 mb-1",src:L,alt:""})],-1)),W={key:0,class:"col-md-4 mb-2 mx-auto"},$={class:"form-group form-check mx-auto"},G=d(()=>s("label",{for:"acceptTerms",class:"form-check-label text-white noticeFont"},"已閱讀以上注意事項並同意參加",-1)),H={class:"invalid-feedback text-center"},J={class:"form-group text-center mt-5 pb-5 d-flex justify-content-evenly"},K={type:"submit",class:"btn btn-primary mr-1 border-white"};function Q(t,e,l,c,o,r){const b=p("VField"),v=p("ErrorMessage"),T=p("VForm");return i(),n("div",j,[s("div",B,[o.isRegistration?(i(),n("div",M,[N,U,s("button",{class:"btn btn-primary my-4 d-block mx-auto border-white",onClick:e[0]||(e[0]=a=>(r.updateInput("update"),o.changeTitle=!0))},"更換其他號碼參加活動"),s("button",{onClick:e[1]||(e[1]=(...a)=>r.goLuckyPage&&r.goLuckyPage(...a)),type:"button",class:"btn btn-secondary my-4 d-block mx-auto"},"查詢抽獎號嗎")])):(i(),E(T,{key:1,onSubmit:e[4]||(e[4]=a=>r.handleOrderSubmit(a))},{default:S(({errors:a})=>[s("div",O,[s("label",q,m(o.changeTitle?"更換手機號碼":"登錄手機號碼抽獎"),1),h(b,{type:"tel",id:"orderTel",name:"手機號碼",class:y(["form-control bg-white",{"is-invalid":a.手機號碼}]),placeholder:"請輸入手機號碼",rules:"required|numeric|min:10|max:10|startsWith09",modelValue:o.userData.tel,"onUpdate:modelValue":e[2]||(e[2]=f=>o.userData.tel=f)},null,8,["class","modelValue"]),h(v,{name:"手機號碼",class:"invalid-feedback"})]),z,o.type==="create"?(i(),n("div",W,[s("div",{class:y(["d-flex",{"is-invalid":a.acceptTerms}])},[s("div",$,[h(b,{name:"acceptTerms",type:"checkbox",id:"acceptTerms",value:!0,class:"form-check-input",rules:"required"}),G])],2),s("div",H,m(a.acceptTerms?"請勾選同意":""),1)])):k("",!0),s("div",J,[s("button",K,m(o.type==="create"?"參加活動":"送出"),1),o.type==="update"?(i(),n("button",{key:0,onClick:e[3]||(e[3]=f=>this.isRegistration=!0),type:"button",class:"btn btn-secondary"},"返回")):k("",!0)])]),_:1}))])])}const Z=I(F,[["render",Q],["__scopeId","data-v-81f94c8a"]]);export{Z as default};
